# 极端天气预警预测系统
## 统计分析与建模期末项目报告

**Academic Year 2025-2026 Semester 1**  
**课程代码：420405 - 统计分析与建模**

---

## 1. 项目背景与研究目标

### 1.1 问题背景

极端天气事件在全球范围内频发，对社会、经济和人民生命财产安全造成重大影响。气象预警系统作为防灾减灾的重要手段，需要不断提升预测准确性和时效性。传统的预警系统主要依赖气象专家的经验判断和简单的时间序列分析，缺乏对预警模式和数据规律的深度挖掘。

### 1.2 研究目标

本项目旨在通过统计分析与建模技术，构建一个基于历史预警数据的智能预测系统，具体目标包括：

1. **预警类型预测**：基于时间特征预测未来可能出现的极端天气预警类型
2. **预警间隔预测**：分析历史预警间隔模式，预测下次预警发生的时间
3. **风险评估**：识别影响预警发布的关键因素，为预警决策提供数据支撑
4. **系统原型**：开发Web应用原型，实现预测结果的可视化展示

### 1.3 项目意义

- **理论意义**：探索机器学习方法在气象预警预测中的应用
- **实践价值**：为气象部门提供数据驱动的预警决策支持
- **社会效益**：提高极端天气预警的准确性和及时性，降低灾害损失

---

## 2. 数据收集与处理过程

### 2.1 数据来源

**数据文件**：`预报预警数据_灾害性天气预警_2920000900329.csv`  
**时间范围**：1年历史数据  
**数据规模**：包含数千条预警记录，数据量控制在10MB以内

### 2.2 数据结构

原始数据包含以下关键字段：
- **发布时间**：预警发布时间
- **信号类型**：极端天气类型（暴雨、台风、雷电等9种类型）
- **信号级别**：预警级别（白色、蓝色、黄色、橙色、红色）
- **发布状态**：发布/取消状态
- **信号影响区域**：受影响地理区域
- **入库时间**：数据入库时间

### 2.3 数据预处理

#### 2.3.1 数据清洗
```python
# 清理空格和特殊字符
for col in ['发布时间', '入库时间']:
    df[col] = df[col].str.strip().str.replace('\t', '')

# 转换时间列为datetime类型
df['发布时间'] = pd.to_datetime(df['发布时间'])
df['入库时间'] = pd.to_datetime(df['入库时间'])
```

#### 2.3.2 区域数据标准化
```python
def clean_region(region):
    if pd.isna(region) or region == '-':
        return '未知区域'
    region = str(region).replace('、', ',').replace('；', ',').replace(' ', '')
    return region
```

#### 2.3.3 特征工程
- **时间特征**：月份、季节、小时、星期几、是否工作日
- **历史特征**：过去30天同类型预警次数、历史平均间隔
- **编码特征**：预警级别数值编码

### 2.4 数据质量评估

- **完整性**：缺失值比例控制在5%以内
- **一致性**：时间格式标准化，区域名称统一
- **有效性**：移除异常预警记录（持续时间>30天）

---

## 3. 建模、优化及性能评估

### 3.1 探索性数据分析

#### 3.1.1 预警类型分布
- **主要预警类型**：暴雨、雷电、台风、雷雨大风
- **发布频率**：雷电预警最为频繁，占总数的25%以上
- **区域分布**：全市范围预警占主导，区域差异显著

#### 3.1.2 时间模式分析
- **季节性**：夏季预警数量最多，冬季最少
- **周期性**：工作日与非工作日预警模式存在差异
- **时段性**：白天预警发布频率高于夜间

#### 3.1.3 级别分布特征
- **蓝色预警**：数量最多，占预警总数的40%
- **红色预警**：数量最少，但影响范围最大
- **类型级别关联**：不同天气类型呈现不同的级别分布模式

### 3.2 模型构建

#### 3.2.1 分类模型（预警类型预测）

**模型选择**：RandomForestClassifier  
**目标变量**：预警类型（9类）  
**特征变量**：
- 时间特征：月份、小时、是否工作日
- 历史特征：过去30天同类型预警次数

**模型参数**：
```python
RandomForestClassifier(n_estimators=50, random_state=42)
```

**性能评估**：
- **准确率**：78.5%
- **交叉验证R²**：0.76 ± 0.08
- **主要评估指标**：精确率、召回率、F1-score

**特征重要性排序**：
1. 过去30天同类型预警次数（0.35）
2. 月份（0.28）
3. 小时（0.22）
4. 是否工作日（0.15）

#### 3.2.2 回归模型（预警间隔预测）

**模型选择**：RandomForestRegressor + XGBoost对比  
**目标变量**：预警间隔时间（天）  
**特征变量**：
- 预警类型、月份、季节
- 预警级别编码
- 历史平均间隔、过去30天预警次数
- 是否工作日

**最优模型**：XGBoost Regressor  
**性能评估**：
- **R² Score**：0.82
- **MSE**：45.6
- **MAE**：4.8天
- **交叉验证R²**：0.79 ± 0.06

**模型对比结果**：
| 模型 | R² Score | MSE | MAE |
|------|----------|-----|-----|
| RandomForest | 0.78 | 52.3 | 5.2 |
| GradientBoosting | 0.80 | 48.1 | 5.0 |
| XGBoost | 0.82 | 45.6 | 4.8 |

### 3.3 模型优化

#### 3.3.1 特征选择
- 使用递归特征消除法进行特征筛选
- 保留重要性评分>0.1的特征
- 最终特征集包含7个核心特征

#### 3.3.2 超参数调优
- **网格搜索**：对关键参数进行网格搜索
- **贝叶斯优化**：使用Optuna进行智能调优
- **最优参数**：
  - n_estimators: 100
  - max_depth: 8
  - learning_rate: 0.1

#### 3.3.3 模型验证
- **时间序列分割**：按时间顺序分割训练/测试集
- **交叉验证**：5折交叉验证确保模型稳定性
- **残差分析**：验证模型假设的合理性

### 3.4 性能评估结果

#### 3.4.1 分类模型评估
```
分类报告：
              precision    recall  f1-score   support

        暴雨       0.82      0.79      0.80       156
        台风       0.75      0.78      0.76        89
        雷电       0.85      0.82      0.83       234
       雷雨大风       0.73      0.76      0.74       127
        高温       0.79      0.81      0.80        98
        强季风       0.71      0.69      0.70        78
      森林火险       0.68      0.71      0.69        65
        寒冷       0.77      0.74      0.75        82
        大雾       0.80      0.83      0.81       156

    accuracy                           0.78      1085
   macro avg       0.77      0.77      0.77      1085
weighted avg       0.78      0.78      0.78      1085
```

#### 3.4.2 回归模型评估
```
模型性能指标：
- R² Score: 0.82
- 均方误差(MSE): 45.6
- 平均绝对误差(MAE): 4.8天
- 均方根误差(RMSE): 6.8天

预测准确性：
- 预测误差在±3天内的比例: 68%
- 预测误差在±7天内的比例: 85%
- 预测误差在±15天内的比例: 95%
```

---

## 4. 模型的解读与实际应用分析

### 4.1 模型核心参数解读

#### 4.1.1 分类模型参数分析

**特征重要性分析**：
1. **过去30天同类型预警次数**（重要性：0.35）
   - 反映天气系统的持续性和周期性
   - 连续性强极端天气事件的预测因子

2. **月份**（重要性：0.28）
   - 体现季节性气候规律
   - 不同月份的天气模式差异显著

3. **小时**（重要性：0.22）
   - 反映日内气象变化规律
   - 某些天气类型具有明显的时段特征

4. **是否工作日**（重要性：0.15）
   - 人类社会活动对预警发布的影响
   - 工作日预警发布更加频繁和规范

#### 4.1.2 回归模型参数分析

**关键影响因素**：
1. **历史平均间隔**（重要性：0.42）
   - 最重要的预测因子
   - 不同天气类型具有不同的间隔规律

2. **预警类型**（重要性：0.25）
   - 天气系统本身的特性决定间隔模式
   - 例如台风间隔长，雷电间隔短

3. **预警级别编码**（重要性：0.18）
   - 高级别预警通常间隔更长
   - 反映灾害严重程度与频率的关系

4. **月份/季节**（重要性：0.15）
   - 季节性气候对预警间隔的影响
   - 夏季极端天气频繁，间隔相对较短

### 4.2 模型业务价值分析

#### 4.2.1 预警资源配置优化
- **人力调度**：根据预测结果优化气象专家值班安排
- **设备准备**：提前准备监测设备和应急物资
- **资金预算**：为高频预警类型预留更多资源

#### 4.2.2 公众服务提升
- **预警发布时机**：根据预测间隔优化预警发布时间
- **信息推送**：为不同用户群体提供个性化预警信息
- **风险评估**：为不同区域和行业提供差异化预警服务

#### 4.2.3 应急响应改进
- **响应准备时间**：根据预警间隔预测提前启动应急响应
- **资源配置**：合理分配应急救援资源
- **协调联动**：优化部门间的应急协调机制

### 4.3 模型应用场景

#### 4.3.1 短期预警预测（1-7天）
- **应用场景**：日常气象服务、公众预警提醒
- **预测精度**：间隔预测误差控制在±3天内
- **服务对象**：公众、企业、政府部门

#### 4.3.2 中期风险评估（1-4周）
- **应用场景**：农业规划、工程建设、旅游安排
- **预测精度**：间隔预测误差控制在±7天内
- **服务对象**：农业部门、建筑企业、旅游业

#### 4.3.3 长期趋势分析（1-3个月）
- **应用场景**：防灾减灾规划、应急预案制定
- **预测精度**：间隔预测误差控制在±15天内
- **服务对象**：政府决策部门、应急管理部门

### 4.4 模型局限性分析

#### 4.4.1 数据局限性
- **时间范围**：仅基于1年数据，样本量有限
- **地理范围**：主要覆盖特定区域，泛化能力待验证
- **变量缺失**：缺少气象要素数据（如温度、湿度、风速等）

#### 4.4.2 模型局限性
- **非线性关系**：复杂气象过程的非线性特征
- **外部冲击**：极端事件和突发天气系统的影响
- **模型假设**：假设历史规律在未来保持稳定

#### 4.4.3 应用局限性
- **实时性要求**：预测模型需要实时更新
- **准确性要求**：预测精度需要进一步提升
- **可解释性**：部分预测结果缺乏明确的物理解释

---

## 5. 团队分工及合作情况

### 5.1 团队组成

**团队规模**：3人小组  
**分工模式**：模块化分工 + 协作开发

### 5.2 具体分工

#### 5.2.1 数据处理与分析（成员A）
**主要职责**：
- 数据收集与清洗
- 探索性数据分析
- 数据可视化制作

**完成成果**：
- 完成15张专业分析图表
- 编写完整的数据预处理pipeline
- 输出详细的EDA报告

**工作亮点**：
- 识别出关键数据质量问题并提出解决方案
- 设计了直观的可视化图表，便于结果解读

#### 5.2.2 机器学习建模（成员B）
**主要职责**：
- 模型算法选择与实现
- 特征工程与模型优化
- 模型性能评估

**完成成果**：
- 构建分类和回归两个核心模型
- 完成模型对比和参数调优
- 实现模型持久化和部署

**工作亮点**：
- 通过XGBoost显著提升回归模型性能
- 设计了完整的模型验证流程

#### 5.2.3 系统开发与集成（成员C）
**主要职责**：
- Web应用原型开发
- 用户界面设计
- 系统集成与测试

**完成成果**：
- 开发Streamlit Web应用
- 实现预测结果可视化展示
- 集成机器学习模型

**工作亮点**：
- 创建了用户友好的交互界面
- 实现了模型的在线预测功能

### 5.3 协作机制

#### 5.3.1 沟通协调
- **定期会议**：每周2次进度同步会议
- **代码共享**：使用Git进行版本控制
- **文档共享**：共享云端文档，确保信息同步

#### 5.3.2 工作流程
1. **需求分析**：共同讨论项目需求和技术方案
2. **并行开发**：各模块并行推进，定期同步进度
3. **集成测试**：各模块完成后进行系统集成
4. **结果评审**：共同评估项目成果和质量

#### 5.3.3 质量控制
- **代码审查**：所有代码变更需要团队成员审查
- **结果验证**：关键结果需要多角度验证
- **文档规范**：统一代码和文档规范

### 5.4 合作成果

#### 5.4.1 项目交付物
- **数据分析报告**：包含15张专业图表和详细分析
- **机器学习模型**：2个训练好的模型文件
- **Web应用原型**：完整可运行的预测系统
- **项目文档**：完整的技术文档和用户手册

#### 5.4.2 团队能力提升
- **技术能力**：团队成员在数据分析、机器学习、Web开发方面均有提升
- **协作能力**：通过项目提升了团队协作和沟通能力
- **项目管理**：学会了项目规划、进度控制和风险管理

---

## 6. 项目总结与反思

### 6.1 项目成果总结

#### 6.1.1 技术成果
1. **数据分析**：完成15张专业可视化图表，揭示了预警数据的关键规律
2. **机器学习**：构建了两个高性能模型，分类准确率达78.5%，回归R²达0.82
3. **系统原型**：开发了完整的Web应用，实现了预测结果的可视化展示
4. **技术文档**：建立了完整的项目文档体系，便于后续维护和扩展

#### 6.1.2 业务价值
1. **决策支持**：为气象预警决策提供了数据驱动的量化工具
2. **资源配置**：帮助优化气象预警资源配置和人员安排
3. **服务提升**：为公众提供更精准、个性化的预警信息服务
4. **风险评估**：建立了系统性的极端天气风险评估框架

#### 6.1.3 学术价值
1. **方法创新**：探索了机器学习在气象预警预测中的应用模式
2. **模型优化**：通过对比实验找到了适合气象数据的算法组合
3. **特征工程**：识别了影响预警预测的关键特征变量
4. **应用示范**：为类似的气象预测项目提供了可复制的技术方案

### 6.2 项目亮点

#### 6.2.1 技术亮点
- **模型融合**：同时实现分类和回归两种预测任务
- **特征工程**：设计了丰富的时间序列和历史统计特征
- **性能优化**：通过XGBoost实现了回归模型的高精度预测
- **系统集成**：将机器学习模型成功集成到Web应用中

#### 6.2.2 应用亮点
- **实用性强**：解决了实际的气象预警预测问题
- **交互友好**：Web界面简洁直观，易于操作
- **结果可视**：预测结果以图表形式直观展示
- **扩展性好**：系统架构支持功能扩展和模型升级

#### 6.2.3 方法亮点
- **数据驱动**：基于真实历史数据进行分析和建模
- **统计严谨**：采用交叉确保模型可靠性
验证等统计方法- **多维评估**：从多个角度评估模型性能和实用性
- **完整闭环**：从数据处理到模型应用形成完整技术链路

### 6.3 项目反思

#### 6.3.1 成功经验
1. **需求导向**：始终围绕实际业务需求设计技术方案
2. **数据优先**：重视数据质量，严格执行数据清洗流程
3. **迭代优化**：通过多次迭代不断完善模型性能
4. **团队协作**：明确的分工和良好的协作机制

#### 6.3.2 挑战与困难
1. **数据质量**：原始数据存在格式不一致、缺失值等问题
2. **特征选择**：需要深入理解气象业务才能选择合适的特征
3. **模型调优**：超参数调优过程复杂，需要大量实验
4. **系统集成**：将机器学习模型集成到Web应用需要解决技术兼容性问题

#### 6.3.3 经验教训
1. **前期调研**：需要更深入的业务调研来指导技术选型
